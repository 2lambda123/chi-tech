import numpy as np
import matplotlib.pyplot as plt
import importlib
import os

script_dir = os.path.dirname(os.path.realpath(__file__))
# execfile('../../ZLFFI00.py')
exec(open(script_dir + '/../../ZLFFI00.py').read())

oldx = np.array([
    0.125,
    0.375,
    0.625,
    0.875,
    1.125,
    1.375,
    1.625,
    1.875,
    2.125,
    2.375,
    2.625,
    2.875,
    3.125,
    3.375,
    3.625,
    3.875,
    4.125,
    4.375,
    4.625,
    4.875])

oldunc = np.array([
    -0.031291,
    -0.0405988,
    -0.0299009,
    -0.0194053,
    -0.0114343,
    -0.00592427,
    -0.00233674,
    -0.000129811,
    0.00113279,
    0.00177375,
    0.00202102,
    0.00203059,
    0.00190628,
    0.00171535,
    0.00149993,
    0.00128533,
    0.00108566,
    0.000907594,
    0.000751872,
    0.000602552])

oldcol = np.array([
    -0.0139736,
    -0.0175955,
    -0.0164389,
    -0.0137294,
    -0.0105259,
    -0.00764805,
    -0.00525547,
    -0.00341182,
    -0.00198287,
    -0.000957798,
    -0.00025551,
    0.000208847,
    0.000468388,
    0.000636086,
    0.000698114,
    0.000690312,
    0.000651591,
    0.000572119,
    0.000482707,
    0.000357545])

old = np.array([
    -0.0452646,
    -0.0581943,
    -0.0463398,
    -0.0331347,
    -0.0219602,
    -0.01357232,
    -0.00759221,
    -0.003541631,
    -0.00085008,
    0.000815952,
    0.00176551,
    0.002239437,
    0.002374668,
    0.002351436,
    0.002198044,
    0.001975642,
    0.001737251,
    0.001479713,
    0.001234579,
    0.000960097])

olduncp9 = np.array([
    -0.00723914,
    -0.0148526,
    -0.013011,
    -0.010094,
    -0.0074195,
    -0.005256,
    -0.00359365,
    -0.00235136,
    -0.00143935,
    -0.000777926,
    -0.000301576,
    0.0000418017,
    0.000293159,
    0.000484619,
    0.000641235,
    0.000781483,
    0.000914766,
    0.00102992,
    0.00104916,
    0.000444388])

oldcolp9 = np.array([
    -0.0180979,
    -0.0250086,
    -0.0274256,
    -0.0272616,
    -0.0256743,
    -0.0233352,
    -0.0207092,
    -0.0180161,
    -0.0154099,
    -0.0129738,
    -0.0107612,
    -0.00876677,
    -0.00700003,
    -0.00544415,
    -0.00409492,
    -0.00294506,
    -0.00199501,
    -0.00125537,
    -0.000764401,
    -0.000568121])

oldp9 = np.array([
    -0.02533704,
    -0.0398612,
    -0.0404366,
    -0.0373556,
    -0.0330938,
    -0.0285912,
    -0.02430285,
    -0.02036746,
    -0.01684925,
    -0.013751726,
    -0.011062776,
    -0.0087249683,
    -0.006706871,
    -0.004959531,
    -0.003453685,
    -0.002163577,
    -0.001080244,
    -0.00022545,
    0.000284759,
    -0.000123733])

plt.figure(1)
plt.clf()
plt.plot(data0[:,3],data0[:,4],label="RMC error - FV")
plt.plot(data1[:,3],data1[:,4],label="RMC error - PWL")
plt.plot(data0[:,3],data3[:,4] - data2[:,4],"k-",label="True error")
# plt.plot(oldx,oldunc,"rd",label="Uncollided")
# plt.plot(oldx,oldcol,"gd",label="Collided")
# plt.plot(oldx,old,"kd",label="Total")
plt.legend()
plt.grid(which='major')
plt.show()

plt.figure(2)
plt.clf()
plt.plot(data0[:,3],data3[:,4],"k-",label="Forward")
plt.plot(data0[:,3],data2[:,4],label="Uncorrected Sn")
plt.plot(data0[:,3],data2[:,4]+data1[:,4],label="Corrected Sn - PWL")
# plt.plot(oldx,oldunc,"rd",label="Uncollided")
# plt.plot(oldx,oldcol,"gd",label="Collided")
# plt.plot(oldx,old,"kd",label="Total")
plt.legend()
plt.grid(which='major')
plt.show()

# print(err_avg12[1,:])
